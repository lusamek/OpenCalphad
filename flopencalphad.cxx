// generated by Fast Light User Interface Designer (fluid) version 1.0304

#include "flopencalphad.h"
#include <stdio.h>
#include <stdlib.h>
#include "ccode.h"
#include <FL/Fl_Output.H>
#include "flopencalphad_def.h"

void redraw() {
  printf("Redraw!\n");
  
  
  strncpy( var_calc_x ,  input_var_calc_x->value() , PATH_MAX );
  strncpy( var_calc_y ,  input_var_calc_y->value() , PATH_MAX );
  // strncpy( var_plot_x ,  input_var_plot_x->value() , PATH_MAX );
  // strncpy( var_plot_y ,  input_var_plot_y->value() , PATH_MAX );
  strncpy( var_tdb_database, input_var_tdb_database->value(), PATH_MAX );  
  
  strncpy( var_system ,      output_system->value() , PATH_MAX );
  // output_system->value( "fe c" );
  // output_system->value( var_system  );
}

Fl_Double_Window *win1=(Fl_Double_Window *)0;

static void cb_Fe(Fl_Button*, void*) {
  printf( " Fe Element Selected\n" );

// printf( "%s\n" ,   inputline->value( browser1->text(  browser1->value() )  ) ) ;

  strncat( var_system , "fe" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
  output_system->value( var_system );
  
  redraw();
}

static void cb_C(Fl_Button*, void*) {
  printf( " C Selected\n" );



  strncat( var_system , "c" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

static void cb_Mn(Fl_Button*, void*) {
  printf( " Mn Selected\n" );


  strncat( var_system , "mn" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );
    
redraw();
}

static void cb_Al(Fl_Button*, void*) {
  printf( " Al Selected\n" );


  strncat( var_system , "al" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );  

redraw();
}

static void cb_Si(Fl_Button*, void*) {
  // printf( "%s\n" ,   inputline->value( browser1->text(  browser1->value() )  ) ) ;


printf( " Si Selected\n" );

  strncat( var_system , "si" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );


redraw();
}

static void cb_V(Fl_Button*, void* v) {
  printf( " V Selected\n" );


  strncat( var_system , "v" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

static void cb_Mo(Fl_Button*, void*) {
  printf( " Mo Selected\n" );

  strncat( var_system , "mo" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

static void cb_Cr(Fl_Button*, void*) {
  printf( " Cr Selected\n" );


  strncat( var_system , "cr" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

static void cb_Cu(Fl_Button*, void*) {
  printf( " Cu Selected\n" );

  strncat( var_system , "cu" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );


redraw();
}

static void cb_Nb(Fl_Button*, void*) {
  printf( " nb Selected\n" );


  strncat( var_system , "nb" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );
    
    
redraw();
}

static void cb_Ni(Fl_Button*, void*) {
  printf( " ni Selected\n" );


  strncat( var_system , "ni" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

static void cb_Ag(Fl_Button*, void*) {
  printf( " ag Selected\n" );


  strncat( var_system , "ag" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

static void cb_Ti(Fl_Button*, void*) {
  printf( " ti Selected\n" );


  strncat( var_system , "ti" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

static void cb_Zn(Fl_Button*, void*) {
  printf( " zn Selected\n" );


  strncat( var_system , "zn" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

static void cb_W(Fl_Button*, void*) {
  printf( " w Selected\n" );


  strncat( var_system , "w" , PATH_MAX - strlen( var_system ) -1 );
  strncat( var_system , " " , PATH_MAX -  strlen( var_system ) -1 );
    output_system->value( var_system );

redraw();
}

Fl_Output *output_system=(Fl_Output *)0;

static void cb_CA(Fl_Button*, void*) {
  printf( " Clr \n" );

// printf( "%s\n" ,   inputline->value( browser1->text(  browser1->value() )  ) ) ;

   strncpy( var_system, "", PATH_MAX );
   output_system->value( var_system );  

   redraw();
}

Fl_Input *input_var_calc_x=(Fl_Input *)0;

static void cb_CA1(Fl_Button*, void*) {
  printf( " Clr \n" );

// printf( "%s\n" ,   inputline->value( browser1->text(  browser1->value() )  ) ) ;

input_var_calc_x->value( "" );

redraw();
}

Fl_Input *input_var_calc_y=(Fl_Input *)0;

static void cb_CA2(Fl_Button*, void*) {
  printf( " Clr \n" );

// printf( "%s\n" ,   inputline->value( browser1->text(  browser1->value() )  ) ) ;

input_var_calc_y->value( "" );

redraw();
}

Fl_Input *input_var_tdb_database=(Fl_Input *)0;

static void cb_CA3(Fl_Button*, void*) {
  printf( " Clr \n" );

// printf( "%s\n" ,   inputline->value( browser1->text(  browser1->value() )  ) ) ;

input_var_tdb_database->value( "" );

redraw();
}

static void cb_Quit(Fl_Button*, void*) {
  exit( 0 );
}

static void cb_3(Fl_Button*, void*) {
  char mydirnow[2500];
  printf( "Current Directory: %s \n", getcwd( mydirnow, 2500 ) );



  redraw();
  nsystem(  "  screen -d  -m   xterm -e   oc   macro.ocm " );
  
  // oc6 bug 
  // gnuplot ocgnu.plt  &;
}

static void cb_2(Fl_Button*, void*) {
  redraw();

nsystem( "  screen -d -m fledit  macro.ocm " );
}

static void cb_1(Fl_Button*, void*) {
  redraw();

clear_plot();


create_macro( );
}

static void cb_4(Fl_Button*, void*) {
  char mydirnow[2500];
  printf( "Current Directory: %s \n", getcwd( mydirnow, 2500 ) );



  redraw();
  nsystem(  "  screen -d  -m  gnuplot ocgnu.plt  " );
  
  
  // oc6 bug 
  // gnuplot ocgnu.plt  &;
}

static void cb_Options(Fl_Button*, void*) {
  win2->show();
}

Fl_Double_Window *win2=(Fl_Double_Window *)0;

static void cb_ls(Fl_Button*, void*) {
  nls();
}

static void cb_xterm(Fl_Button*, void*) {
  nsystem( " screen -d -m xterm " );
}

static void cb_calc(Fl_Button*, void*) {
  nsystem( " screen -d -m fl48 " );
}

static void cb_fledit(Fl_Button*, void*) {
  nsystem( " screen -d -m fledit " );
}

static void cb_ccode(Fl_Button*, void*) {
  nsystem( " screen -d -m fledit flopencalphad_def.h  " );
}

Fl_Browser *browser1=(Fl_Browser *)0;

static void cb_browser1(Fl_Browser*, void*) {
  printf( "Click\n" );



 input_var_tdb_database->value(  browser1->text(   browser1->value() ) ); 

redraw();
}

Fl_Input *input_notes=(Fl_Input *)0;

static void cb_Add(Fl_Button*, void*) {
  browser1->add(   input_notes->value()  );

// if (  browser1->value() >= 1 )  printf( "%s\n" ,   browser1->text(  browser1->value() )  )  ;
}

static void cb_Edit(Fl_Button*, void*) {
  redraw();
  
  char charo[PATH_MAX];
  strncpy( charo, "", PATH_MAX );
  strncat( charo , " screen -d -m  fledit  " , PATH_MAX - strlen( charo ) -1 );
  strncat( charo , " " , PATH_MAX -  strlen( charo ) -1 );
  strncat( charo , " \"" , PATH_MAX -  strlen( charo ) -1 );
  strncat( charo , var_tdb_database , PATH_MAX -  strlen( charo ) -1 );
  strncat( charo , "\" " , PATH_MAX -  strlen( charo ) -1 );
  nsystem(  charo );
}

static void cb_ls1(Fl_Button*, void*) {
  redraw();

  printf( "============================\n" );
  printf( "   DATABASE                 \n" );
  printf( "============================\n" );
  
  nlsgrep( ".tdb" );
  nlsgrep( ".TDB" );
}

static void cb_Element(Fl_Button*, void*) {
  redraw();
  
  
  printf( "============================\n" );
  printf( "   ELEMENT                  \n" );
  printf( "============================\n" );
  
  
  
  filegrep( var_tdb_database , "ELEM" );
}

static void cb_Browse(Fl_Button*, void*) {
  redraw();

  printf( "============================\n" );
  printf( "   DATABASE                 \n" );
  printf( "============================\n" );
  
  nlsgrep( ".tdb" );
  nlsgrep( ".TDB" );
  
  
  printf( "============================\n" );
  printf( "   DATABASE                 \n" );
  printf( "============================\n" );

  
        browser1->clear();
	DIR *dirp;
	struct dirent *dp;
	dirp = opendir( "." );
	while  ((dp = readdir( dirp )) != NULL ) 
	{
		if (  strcmp( dp->d_name, "." ) != 0 )
		if (  strcmp( dp->d_name, ".." ) != 0 )
                {
                    if ( ( strstr( dp->d_name, ".TDB" ) != 0 )  || ( strstr( dp->d_name, ".tdb" ) != 0 )  ) 
                    {
			printf( "%s\n", dp->d_name );
 		        browser1->add(  dp->d_name  );
 		     }
                }
	}
	closedir( dirp );
}

static void cb_Species(Fl_Button*, void*) {
  redraw();
  
  
  printf( "============================\n" );
  printf( "   SPECIES                  \n" );
  printf( "============================\n" );
  
  
  
  filegrep( var_tdb_database , "SPECIE" );
}

static void cb_Path(Fl_Button*, void*) {
  redraw();

  printf( "============================\n" );
  printf( "   PATH                     \n" );
  printf( "============================\n" );
  
    char mydirnow[2500];
  printf( "Current Directory: %s \n", getcwd( mydirnow, 2500 ) );
}

static void cb_Close(Fl_Button*, void*) {
  nsystem( " pkill gnuplot " );
}

Fl_Double_Window* make_window() {
  { win1 = new Fl_Double_Window(775, 700, "Notes");
    { Fl_Box* o = new Fl_Box(30, 25, 710, 30, "FLTK OpenCalphad");
      o->box(FL_ENGRAVED_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
    } // Fl_Box* o
    { Fl_Group* o = new Fl_Group(30, 85, 350, 155, "1. Element");
      o->box(FL_DOWN_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
      { Fl_Button* o = new Fl_Button(40, 95, 45, 35, "Fe");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Fe);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(100, 95, 45, 35, "C");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_C);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(160, 95, 45, 35, "Mn");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Mn);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(220, 95, 45, 35, "Al");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Al);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(280, 95, 45, 35, "Si");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Si);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(280, 185, 45, 35, "V");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_V);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(159, 140, 45, 35, "Mo");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Mo);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(100, 140, 45, 35, "Cr");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Cr);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(100, 185, 45, 35, "Cu");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Cu);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(280, 140, 45, 35, "Nb");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Nb);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(40, 140, 45, 35, "Ni");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Ni);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(40, 185, 45, 35, "Ag");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Ag);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(220, 140, 45, 35, "Ti");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Ti);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(160, 185, 45, 35, "Zn");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_Zn);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(220, 185, 45, 35, "W");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_W);
      } // Fl_Button* o
      o->end();
    } // Fl_Group* o
    { Fl_Group* o = new Fl_Group(30, 270, 350, 150, "2. Compute");
      o->box(FL_DOWN_FRAME);
      o->labeltype(FL_ENGRAVED_LABEL);
      { output_system = new Fl_Output(95, 285, 205, 25, "System");
        output_system->color(FL_BACKGROUND_COLOR);
        output_system->value( "fe c" );
      } // Fl_Output* output_system
      { Fl_Button* o = new Fl_Button(305, 285, 30, 25, "CA");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_CA);
      } // Fl_Button* o
      { input_var_calc_x = new Fl_Input(95, 315, 205, 25, "X var.");
        input_var_calc_x->value( "c" );
      } // Fl_Input* input_var_calc_x
      { Fl_Button* o = new Fl_Button(305, 315, 30, 25, "CA");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_CA1);
      } // Fl_Button* o
      { input_var_calc_y = new Fl_Input(95, 345, 205, 25, "Y var.");
        input_var_calc_y->value( "T" );
      } // Fl_Input* input_var_calc_y
      { Fl_Button* o = new Fl_Button(305, 345, 30, 25, "CA");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_CA2);
      } // Fl_Button* o
      { input_var_tdb_database = new Fl_Input(95, 375, 205, 25, "TDB");
        input_var_tdb_database->value( "steel1.tdb" );
      } // Fl_Input* input_var_tdb_database
      { Fl_Button* o = new Fl_Button(305, 375, 30, 25, "CA");
        o->labelfont(1);
        o->labelsize(12);
        o->callback((Fl_Callback*)cb_CA3);
      } // Fl_Button* o
      o->end();
      Fl_Group::current()->resizable(o);
    } // Fl_Group* o
    { Fl_Button* o = new Fl_Button(290, 650, 95, 30, "&Quit");
      o->callback((Fl_Callback*)cb_Quit);
    } // Fl_Button* o
    { Fl_Group* o = new Fl_Group(30, 450, 350, 170, "3. OCM GNUPlot");
      o->box(FL_DOWN_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
      { Fl_Button* o = new Fl_Button(135, 540, 145, 25, "[&3] Compute!");
        o->callback((Fl_Callback*)cb_3);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(135, 505, 145, 25, "[&2] Edit!");
        o->callback((Fl_Callback*)cb_2);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(135, 470, 145, 25, "[&1] Create!");
        o->callback((Fl_Callback*)cb_1);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(135, 575, 145, 25, "[&4] Plot!");
        o->callback((Fl_Callback*)cb_4);
      } // Fl_Button* o
      o->end();
    } // Fl_Group* o
    { Fl_Button* o = new Fl_Button(30, 650, 245, 30, "&Options");
      o->callback((Fl_Callback*)cb_Options);
    } // Fl_Button* o
    { Fl_Group* o = new Fl_Group(390, 85, 345, 535, "Output");
      o->box(FL_DOWN_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
      o->end();
    } // Fl_Group* o
    win1->end();
  } // Fl_Double_Window* win1
  { win2 = new Fl_Double_Window(890, 330);
    { Fl_Box* o = new Fl_Box(15, 25, 855, 35, "FLTK OpenCalphad -- Options");
      o->box(FL_ENGRAVED_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
    } // Fl_Box* o
    { Fl_Group* o = new Fl_Group(15, 100, 285, 45, "System Call");
      o->box(FL_DOWN_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
      { Fl_Button* o = new Fl_Button(25, 110, 50, 25, "&ls");
        o->callback((Fl_Callback*)cb_ls);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(80, 110, 50, 25, "&xterm");
        o->callback((Fl_Callback*)cb_xterm);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(135, 110, 50, 25, "&calc");
        o->callback((Fl_Callback*)cb_calc);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(190, 110, 50, 25, "&fledit");
        o->callback((Fl_Callback*)cb_fledit);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(245, 110, 50, 25, "ccode");
        o->callback((Fl_Callback*)cb_ccode);
      } // Fl_Button* o
      o->end();
    } // Fl_Group* o
    { Fl_Group* o = new Fl_Group(15, 170, 285, 140, "Browser");
      o->box(FL_DOWN_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
      { browser1 = new Fl_Browser(25, 180, 260, 90);
        browser1->callback((Fl_Callback*)cb_browser1);
        Fl_Group::current()->resizable(browser1);
        browser1->type(FL_HOLD_BROWSER);
      } // Fl_Browser* browser1
      { input_notes = new Fl_Input(70, 275, 165, 25, "Notes");
        input_notes->tooltip("Demo");
        input_notes->color((Fl_Color)55);
      } // Fl_Input* input_notes
      { Fl_Button* o = new Fl_Button(240, 275, 45, 25, "&Add");
        o->callback((Fl_Callback*)cb_Add);
      } // Fl_Button* o
      o->end();
    } // Fl_Group* o
    { Fl_Group* o = new Fl_Group(325, 100, 285, 205, "Database");
      o->box(FL_DOWN_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
      { Fl_Button* o = new Fl_Button(335, 110, 50, 25, "&Edit");
        o->callback((Fl_Callback*)cb_Edit);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(390, 110, 50, 25, "ls tdb");
        o->callback((Fl_Callback*)cb_ls1);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(445, 110, 75, 25, "Element");
        o->callback((Fl_Callback*)cb_Element);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(525, 110, 70, 25, "Browse");
        o->callback((Fl_Callback*)cb_Browse);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(445, 140, 75, 25, "Species");
        o->callback((Fl_Callback*)cb_Species);
      } // Fl_Button* o
      { Fl_Button* o = new Fl_Button(390, 140, 50, 25, "Path");
        o->callback((Fl_Callback*)cb_Path);
      } // Fl_Button* o
      o->end();
    } // Fl_Group* o
    { Fl_Group* o = new Fl_Group(620, 100, 245, 205, "Plot");
      o->box(FL_DOWN_BOX);
      o->labeltype(FL_ENGRAVED_LABEL);
      { Fl_Button* o = new Fl_Button(630, 110, 90, 25, "Close &Plots");
        o->callback((Fl_Callback*)cb_Close);
      } // Fl_Button* o
      o->end();
    } // Fl_Group* o
    win2->end();
    win2->resizable(win2);
  } // Fl_Double_Window* win2
  return win2;
}

void addkeypress( int keypress ) {
  //char str[PATH_MAX]; 
     //snprintf( str , sizeof( str ), "%s%c", inputline->value() , keypress ); 
     //inputline->value( str  );
}

int main( int argc, char *argv[]) {
  // working dir 
    if ( argc == 2)
    if ( strcmp( argv[1] , "" ) !=  0 )
    {
            chdir( argv[ 1 ] );
    }
    
    char mydirnow[2500];
    printf( "Current Directory: %s \n", getcwd( mydirnow, 2500 ) );
  
    // vars
    strncpy( var_system, "", PATH_MAX);
    
  
    make_window();
    win1->show();
  
    Fl::run();
}
